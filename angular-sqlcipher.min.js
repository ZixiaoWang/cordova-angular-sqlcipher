angular.module("ngSqlcipher",[]).provider("sqlcipherConfig",function(){var n={name:"admin",password:"admin",location:"default"},t=!1;this.onConnectSuccess=new Function,this.onConnectError=new Function,this.onSuccess=new Function,this.onError=new Function,this.test=function(n,e){t=!0,n&&(this.onConnectSuccess=n),e&&(this.onConnectError=e)},this.open=function(t,e,o){null!=t.name&&void 0!=t.name?n.name=t.name:null!=t.password&&void 0!=t.password?n.password=t.password:null!=t.location&&void 0!=t.location?n.location=t.location:null!=t.iosDatabaseLocation&&void 0!=t.iosDatabaseLocation&&(n.iosDatabaseLocation=t.iosDatabaseLocation),e&&(this.onSuccess=e),o&&(this.onError=o)},this.$get=["$window",function(e){var o;return t&&e.sqlitePlugin.echoTest(this.onConnectSuccess,this.onConnectError),o=e.sqlitePlugin.openDatabase(n,this.onSuccess,this.onError),o.__proto__.addTrans=o.__proto__.addTransaction,o.__proto__.addTransaction=function(n){n.__proto__.exec=n.__proto__.executeSql,o.__proto__.addTrans.call(this,n)},o}]}).factory("$sqlcipher",["sqlcipherConfig","$window","$q",function(n,t,e){var o=function(){this.core=n,this._version=null};return o.prototype.exec=function(t,o){return e(function(e,r){n.executeSql(t,o,e,r)})},o.prototype.batch=function(t){return e(function(e,o){n.sqlBatch(t,e,o)})},o.prototype.trans=function(t){return e(function(e,o){n.transaction(t,o,e)})},o.prototype.readTrans=function(t){return e(function(e,o){n.transaction(t,o,e)})},o.prototype.close=function(){return e(function(t,e){n.close(t,e)})},o.prototype.createTable=function(t,o,r,i){function a(n){return"string"==typeof n?'"'+n+'"':Array.isArray(n)?JSON.stringify(n):"boolean"==typeof n?n:"number"==typeof n?n:"null"==typeof n||"undefined"==typeof n?null:"function"==typeof n?n():n.toString()}var u="CREATE TABLE IF NOT EXISTS "+t+" ",c=[],s="";if(Array.isArray(o)||"object"!=typeof o)if("string"==typeof o)u+="("+o+")";else if(o instanceof Array)o.forEach(function(n,t){"string"==typeof n?c.push(n):"object"==typeof n&&(s="",s+=n.name+" ",s+=n.type?n.type+" ":"",s+=n.notNull?"NOT NULL ":"",s+=n.primary?"PRIMARY KEY ":"",s+=n.autoIncrement?"AUTOINCREMENT ":"",s+=n["default"]?"DEFAULT "+a(n["default"]):"",s+=n.unique?"UNIQUE ":"",s+=n.check?n.check:"",c.push(s))}),u+="("+c.join(", ")+")";else{if(void 0!==o)throw new Error("Options has to be String or Array");console.warn("Table columns are suggested to be configured! column ID will be created automatically."),u+="(id INTEGER )"}else Object.keys(o).forEach(function(n){s="",s=n+" ",s+=o[n].type?o[n].type:"",s+=o[n].notNull?"NOT NULL ":"",s+=o[n].primary?"PRIMARY KEY ":"",s+=o[n].autoIncrement?"AUTOINCREMENT ":"",s+=o[n]["default"]?"DEFAULT "+a(o[n]["default"]):"",s+=o[n].unique?"UNIQUE ":"",s+=o[n].check?o[n].check:"",c.push(s)}),u+="("+c.join(",")+")";return e(function(t,e){n.executeSql(u,[],t,e)})},o.prototype.dropTable=function(t,o,r){if("string"!=typeof t)throw new Error("Table name must be in String type.");var i="DROP TABLE "+t;return e(function(t,e){n.executeSql(i,[],t,e)})},o.prototype.truncate=function(t){if("string"!=typeof t)throw new Error("Table name must be in String type.");return e(function(e,o){n.executeSql("DELETE FROM "+t,e,o)})},o.prototype.select=function(t,o,r){var i="",a=[],u=r;if("string"!=typeof t)throw new Error("table name must be a String.");if(null==o)i="SELECT * FROM "+t;else if(o instanceof Array&&0==o.length)i="SELECT * FROM "+t;else{if(!(o instanceof Array&&o.length>0))throw new Error(o+"cannot resolve type.");a=o.join(),i="SELECT "+a+" FROM "+t+" "}return u&&(u.where&&(i+=" WHERE "+u.where.replace(/&&/g," AND ").replace(/\|\|/g," OR ")),u.groupby&&(u.groupby instanceof Array?(i+=" GROUP BY ",i+=u.groupby.join()):"string"==typeof u.groupby&&(i+=" GROUP BY",i+=u.groupby)),u.having&&"string"==typeof u.having&&(i+=" HAVING ",i+=u.having),u.orderby&&u.orderby instanceof Array?i+=" ORDER BY "+u.orderby.join():u.orderby&&"string"==typeof u.orderby&&(i+=" ORDER BY "+u.orderby),"string"==typeof u.sort&&"desc"===u.sort.toLowerCase&&u.orderby?i+=" DESC":u.orderby&&(i+=" ASC")),console.log(i),e(function(t,e){n.executeSql(i,[],t,e)})},o.prototype.selectAll=function(t){if("string"!=typeof t)throw new Error("Table name must be in String type.");var o="SELECT * FROM "+t;return e(function(t,e){n.executeSql(o,[],t,e)})},o.prototype.insert=function(t,o){function r(n){return"string"==typeof n||"boolean"==typeof n?'"'+n+'"':Array.isArray(n)?JSON.stringify(n):"number"==typeof n?n:"null"==typeof n||"undefined"==typeof n?null:"function"==typeof n?n():n.toString()}function i(t,e,i){for(var f=0;f<t.rows.length;f++)a.push(t.rows.item(f).name);return o.forEach(function(n,t){var e=[];0==t?(c+=" SELECT ",a.forEach(function(t,o){void 0!==n[t]&&(-1===u.indexOf(t)&&u.push(t),e.push(r(n[t])+" AS "+t))}),c+=e.join(", "),e=[]):(c+=" UNION ALL SELECT ",a.forEach(function(t,o){void 0!==n[t]&&(-1===u.indexOf(t)&&u.push(t),e.push(r(n[t])+" AS "+t))}),c+=e.join(", "),e=[])}),c=s+" ( "+u.join(", ")+" )"+c,console.log(c),n.executeSql(c,[],e,i)}if("string"!=typeof t)throw new Error(t+" is not a String.");if(!(o instanceof Array))throw new Error("options must be an Array");if(0==o.length)throw new Error("option length is 0");var a=[],u=[],c="",s="INSERT INTO "+t;return e(function(e,o){n.executeSql("PRAGMA table_info("+t+")",[],function(n){return i(n,e,o)},o)})},o.prototype.renameTable=function(t,o){return e(function(e,r){n.executeSql("ALTER TABLE "+t+" RENAME TO "+o,[],e,r)})},o.prototype.addColumns=function(t,o){if("string"!=typeof t)throw new Error("table name is not a string");if("string"==typeof o)return e(function(e,r){n.executeSql("ALTER TABLE "+t+" ADD COLUMN "+o)});if(o instanceof Array){var r=[],i="ALTER TABLE "+t+" ADD COLUMN ",a="";return 0==o.length?(console.warn("No columns are added."),null):(o.forEach(function(n,t){"string"==typeof n?r.push(i+n):"object"==typeof n&&(a="",a+=n.name+" ",a+=n.type?n.type+" ":"",a+=n.notNull?"NOT NULL ":"",a+=n.primary?"PRIMARY KEY ":"",a+=n.autoIncrement?"AUTOINCREMENT ":"",a+=n["default"]?"DEFAULT "+n["default"]:"",a+=n.unique?"UNIQUE ":"",a+=n.check?n.check:"",r.push(i+a))}),e(function(t,e){n.transaction(function(n){r.forEach(function(t){n.executeSql(t)})},e,t)}))}throw new Error("options must be String or Array.")},o.prototype.update=function(t,o,r){if("string"!=typeof t)throw new Error("table name must be String");if("object"!=typeof o)throw new Error("options must be an options");var i="UPDATE "+t+" SET ",a=[],u=r,c=Object.keys(o);return c.forEach(function(n,t){if("number"==typeof o[n])a.push(n+" = "+o[n]);else if("string"==typeof o[n]||"boolean"==typeof o[n])a.push(n+' = "'+o[n]+'"');else if("function"==typeof o[n]){var e=o[n]();if("number"==typeof e)a.push(n+" = "+e);else{if("string"!=typeof e)throw new Error(n+" cannot resolve type.");a.push(n+' = "'+e+'"')}}else a.push(n+' = "'+JSON.stringify(o[n])+'"')}),i+=a.join(),u&&u.where&&(i+=" WHERE "+u.where.replace(/&&/g," AND ").replace(/\|\|/g," OR ")),e(function(t,e){n.executeSql(i,[],t,e)})},new o}]).factory("$tools",function(){return{dataMassager:function(n){for(var t=[],e=0;e<n.rows.length;e++)t.push(n.rows.item(e));return t}}});
